# دليل إعداد البريد الإلكتروني - آفاق المتكاملة

## ✅ تم إصلاح نظام البريد الإلكتروني

تم تحديث نظام إرسال البريد الإلكتروني ليرسل تلقائياً إلى **info@afaqinfotech.com** عند إتمام أي طلب.

## 📧 ما يحدث عند إتمام الطلب:

1. **إيميل داخلي إلى info@afaqinfotech.com** يحتوي على:
   - رقم الطلب
   - تاريخ ووقت الطلب
   - بيانات العميل الكاملة (الاسم، البريد، الهاتف)
   - تفاصيل المنتجات المطلوبة
   - المجموع الكلي
   - الرسالة الإضافية من العميل (إن وجدت)
   - الإجراءات المطلوبة

2. **إيميل تأكيد للعميل** يحتوي على:
   - رقم الطلب للمتابعة
   - ملخص الطلب
   - تأكيد استلام الطلب
   - معلومات التواصل

## 🚀 خطوات التفعيل (مطلوبة):

### الخطوة 1: التسجيل في Resend
1. اذهب إلى [resend.com](https://resend.com)
2. أنشئ حساب مجاني (3000 إيميل شهرياً مجاناً)
3. قم بالتحقق من بريدك الإلكتروني

### الخطوة 2: الحصول على API Key
1. بعد تسجيل الدخول، اذهب إلى [API Keys](https://resend.com/api-keys)
2. اضغط على "Create API Key"
3. أعط المفتاح اسم (مثل: "AFAQ Store")
4. اختر "Full Access" للصلاحيات
5. انسخ المفتاح (سيظهر مرة واحدة فقط!)

### الخطوة 3: إضافة Domain (اختياري ولكن موصى به)
لإرسال الإيميلات من `noreply@afaqinfotech.com`:

1. اذهب إلى [Domains](https://resend.com/domains)
2. اضغط "Add Domain"
3. أدخل `afaqinfotech.com`
4. أضف سجلات DNS المطلوبة في لوحة تحكم الدومين
5. انتظر التحقق (قد يستغرق بضع دقائق)

**ملاحظة:** إذا لم تضف الدومين، سيتم الإرسال من `onboarding@resend.dev` وهذا يعمل أيضاً.

### الخطوة 4: تحديث ملف .env.local

افتح ملف `.env.local` في المجلد الرئيسي واستبدل `re_your_api_key_here` بالمفتاح الحقيقي:

```bash
# استبدل هذا السطر:
RESEND_API_KEY=re_your_api_key_here

# بالمفتاح الحقيقي من Resend:
RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxxxxxxxxxx
```

إذا أضفت الدومين، حدّث أيضاً:
```bash
FROM_EMAIL=noreply@afaqinfotech.com
TO_EMAIL=info@afaqinfotech.com
```

### الخطوة 5: إعادة تشغيل السيرفر

```bash
# أوقف السيرفر إذا كان يعمل (Ctrl+C)
# ثم شغله من جديد:
npm run dev
```

## ✅ اختبار النظام

1. افتح المتجر: [http://localhost:3000/store](http://localhost:3000/store)
2. أضف منتج إلى السلة
3. اذهب إلى السلة ثم "إتمام الطلب"
4. املأ البيانات وأرسل الطلب
5. تحقق من inbox في info@afaqinfotech.com

## 🔍 التحقق من حالة الإرسال

راجع console في Terminal بعد إرسال الطلب:

✅ **نجاح الإرسال:**
```
🔄 محاولة إرسال الإيميل عبر Resend...
✅ تم إرسال الإيميل الداخلي بنجاح إلى info@afaqinfotech.com!
✅ تم إرسال إيميل التأكيد للعميل بنجاح!
```

❌ **فشل الإرسال:**
```
⚠️ لم يتم تعيين RESEND_API_KEY، سيتم المحاكاة فقط
```

## 📝 محتوى الإيميل المرسل إلى info@afaqinfotech.com

الإيميل منسق بشكل احترافي ويحتوي على:

### 📋 معلومات الطلب
- رقم الطلب: AFQ-[timestamp]
- تاريخ ووقت الطلب

### 👤 بيانات العميل
- الاسم الكامل
- البريد الإلكتروني (مع زر Reply)
- رقم الهاتف
- الرسالة الإضافية (إن وجدت)

### 🛒 تفاصيل الطلب
- قائمة المنتجات مع:
  - اسم المنتج
  - الكمية
  - السعر الفردي
  - المجموع لكل منتج
- المجموع الكلي بارز

### 🔔 الإجراءات المطلوبة
- التواصل مع العميل خلال 24 ساعة
- تأكيد تفاصيل الطلب
- ترتيب عملية الدفع
- تفعيل الخدمات

## 🛠️ بدائل أخرى (إذا لم تنجح Resend)

### استخدام Gmail SMTP:
1. افتح `.env.local`
2. أضف:
```bash
GMAIL_USER=your-email@gmail.com
GMAIL_APP_PASSWORD=xxxx-xxxx-xxxx-xxxx
```
3. عدّل الكود في `src/app/api/send-order/route.ts` (التعليمات موجودة في الملف)

### استخدام SMTP مخصص:
```bash
SMTP_HOST=smtp.afaqinfotech.com
SMTP_PORT=587
SMTP_USER=noreply@afaqinfotech.com
SMTP_PASSWORD=your-password
```

## 🎯 الخلاصة

✅ **تم إصلاح النظام ليرسل إلى info@afaqinfotech.com**
✅ **الإيميل يحتوي على كل معلومات الطلب والعميل**
✅ **تصميم احترافي باللغة العربية**
✅ **يرسل نسخة تأكيد للعميل أيضاً**

**المطلوب منك فقط:**
1. التسجيل في resend.com
2. الحصول على API Key
3. وضع المفتاح في `.env.local`
4. إعادة تشغيل السيرفر

---

📧 **لأي مساعدة أو استفسارات، راجع الملفات:**
- `.env.local` - إعدادات البريد
- `src/app/api/send-order/route.ts` - كود إرسال البريد
- هذا الملف للتوجيهات
